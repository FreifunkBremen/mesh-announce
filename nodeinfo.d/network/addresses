# filter addresses from /proc/net/if_inet6 belonging to given ifaces
(lambda ifaces:
    [
        str(import_module("ipaddress").IPv6Address(int(line[0], 16)))
        for line in map(str.split, open('/proc/net/if_inet6'))
        if line[5] in ifaces
            and not int(line[4], 16) & (0x40 | 0x20)
            # address is neither tentative nor deprecated
    ]
)([dev for devgroup in (lambda devs:[
    # generate the list of ifaces
    [dev] +
    list(map(
      lambda s: s[len('/sys/class/net/{}/upper_'.format(dev)):],
      import_module('glob').glob('/sys/class/net/{}/upper_*'.format(dev))
    ))
    for dev in devs
  ])([ batadv_dev ] + batadv_dev_extra)
  for dev in devgroup
])
